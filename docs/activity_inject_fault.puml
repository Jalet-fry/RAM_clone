@startuml activity_inject_fault
!theme plain

title Диаграмма активности: Внедрение неисправности

start

:Пользователь нажимает\n"Внедрить неисправность";

:Получить модель неисправности\nиз ComboBox;

:Получить адрес\nиз LineEdit;

:Получить длину\nиз LineEdit;

:Получить вероятность\nиз DoubleSpinBox;

if (Валидация ввода?) then (невалидно)
    :Показать сообщение об ошибке;
    :Записать в лог;
    stop
endif

if (Адрес >= размер памяти?) then (да)
    :Показать сообщение об ошибке;
    :Записать в лог;
    stop
endif

if (Адрес + длина > размер памяти?) then (да)
    :Уменьшить длину до\nразмер памяти - адрес;
    :Показать предупреждение;
    :Записать в лог;
endif

:Создать InjectedFault:\nmodel, addr, len, flip_probability;

:Вызвать MemoryModel.injectFault();

:MemoryModel передает\nнеисправность в FaultInjector;

:FaultInjector сохраняет\nнеисправность;

:Отправить сигнал faultInjected();

:Обновить таблицу памяти;

:Обновить статистику;

:Записать в лог:\n"Внедрена неисправность";

stop

@enduml

